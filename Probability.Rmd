---
title: "SoySdTrtLogisticProb"
author: "Devon"
date: "April 28, 2016"
output: html_document
---

```{r, echo=TRUE}
library(knitr)
library(markdown)
library(car)
library(scatterplot3d)
library(lme4)
library(aod)
library(Rcpp)
library(ggplot2)
library(plyr)
library(Rmisc)
library(scales)
library(HSAUR)
library(Hmisc)
library(drc)
library(plot3D)
library(boot)
library(pheatmap)
Y <- (read.csv("/Users/devonrossman/Desktop/CSVforR/SoySdTrt/CSVFiles/CAD.csv"))
Y3<-subset(Y, !(Y$Diff8=="NA") & !(Y$sdtrt=="CON")
           )
Y3$stcost <- ifelse(Y3$sdtrt == "F", 4, ifelse((Y3$sdtrt =="F+I"), 10, 20))
Diff<-function(x){
  cry<-(Y3$stcost/(Y3$yield*x))
  diff<-(Y3$RR-cry)
  return(diff)
}

output<-as.data.frame(NULL)
for(i in c(6,10,14)){
DIFF<-Diff(i)
output_i<-cbind.data.frame(Y3, DIFF, i)
output<-rbind.data.frame(output,output_i)
}
output$soycost<-as.numeric(output$i)
output$Diff<-as.numeric(output$DIFF)

D <-( ddply(output, c("location", "var", "sdtrt", "soycost", "Low5wk", "YL"), summarise,
               N    = length(Diff),
               mean = mean(Diff),
               sd   = sd(Diff),
               se   = sd / sqrt(N),
            scale=sd*0.551328895))
D$N <- ifelse(D$mean < 0, 0, ifelse((D$mean > 0), 1, 1))
D$var <- as.factor(D$var)

m <- glmer(N ~ sdtrt + Low5wk + soycost + location + (1 | var), data = D, family = binomial, control = glmerControl(optimizer = "bobyqa"), nAGQ = 10)
rsq <- function(formula, data, indices) {
  d <- data[indices,] # allows boot to select sample 
  fit <- lm(formula, data=d)
  return(summary(fit)$r.square)
}

m2 <- glm(N ~ sdtrt + Low5wk + soycost + location, data = D, family = binomial, control = glmerControl(optimizer = "bobyqa"), nAGQ = 10)
rsq2 <- function(formula, data, indices) {
  d <- data[indices,] # allows boot to select sample 
  fit <- lm(formula, data=d)
  return(summary(fit)$r.square)
}


# bootstrapping with 1000 replications 
results <- boot(data=D, statistic=rsq, 
  	R=1000, formula=N~sdtrt+location+soycost+var+Low5wk)
resultsa <-boot(data=D, statistic=rsq2, 
  	R=1000, formula=N~sdtrt+location+soycost+Low5wk)

lgt1 <- glm(N ~ soycost + location + Low5wk + sdtrt + var, data = results$data, family = "binomial")
#summary(lgt1)
lgt2 <-glm(N ~ soycost + location + Low5wk + sdtrt, data = resultsa$data, family = "binomial")

D1 <- cbind(D, predict(lgt1, type=c("link", "response", "terms"), se=TRUE))
D1 <- within(D1, {
  PredictedProb <- plogis(fit)
  LL <- plogis(fit - (1.96 * se.fit))
  UL <- plogis(fit + (1.96 * se.fit))
  }
)

D2 <- cbind(D, predict(lgt2, type=c("link", "response", "terms"), se=TRUE))
D2 <- within(D2, {
  PredictedProb <- plogis(fit)
  LL <- plogis(fit - (1.96 * se.fit))
  UL <- plogis(fit + (1.96 * se.fit))
  }
)

chisq.test(x=D1$PredictedProb, y=D2$PredictedProb)

#McFaddens Pseudo R-squared
#1 - (Residual variance / Null variance)
1-(729.98/1318.59)

D1$locst<-paste(D1$location, D1$sdtrt)
scatterplot(PredictedProb ~ var | locst, data=D1,
  	xlab="5 wk Low Temps", ylab="Probability of Breaking Even", legend.coords = "topleft",
   main="Enhanced Scatter Plot") 
probsub <-(D1)
probsub$paste <- paste(probsub$YL, probsub$sdtrt, probsub$var)
stuff<-as.data.frame(cbind(probsub$PredictedProb, probsub$N))
#rownames(stuff)<-probsub$paste
colnames(stuff)<-c("Predicted Probability", "Break Even")
pheatmap(stuff, show_rownames = TRUE, show_colnames = TRUE,
         #cluster_rows=hc.rows, 
         clustering_method="average")
write.csv(D1, ("/Users/devonrossman/Desktop/CSVforR/SoySdTrt/CSVFiles/P/Prob.csv"))

#wald.test(b = coef(lgt), Sigma = vcov(lgt), Terms=11:12)
ALED1<-subset(D1, (D1$location=="ALE"))
mean(ALED1$PredictedProb)
HILD1<-subset(D1, (D1$location=="HIL"))
mean(HILD1$PredictedProb)
IN2D1<-subset(D1, (D1$location=="IN2"))
mean(IN2D1$PredictedProb)
LEND1<-subset(D1, (D1$location=="LEN"))
mean(LEND1$PredictedProb)
SAGD1<-subset(D1, (D1$location=="SAG"))
mean(SAGD1$PredictedProb)
SAND1<-subset(D1, (D1$location=="SAN"))
mean(SAND1$PredictedProb)
STJD1<-subset(D1, (D1$location=="STJ"))
mean(STJD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$sdtrt=="F"))
mean(sdtrtD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$sdtrt=="F+I"))
mean(sdtrtD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$sdtrt=="F+I+N"))
mean(sdtrtD1$PredictedProb)
varD1<-subset(D1, (D1$var=="1"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$var=="2"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$var=="3"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$var=="4"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$var=="5"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$var=="6"))
mean(varD1$PredictedProb)
soycostD1<-subset(D1, (D1$soycost=="6"))
mean(soycostD1$PredictedProb)
soycostD1<-subset(D1, (D1$soycost=="10"))
mean(soycostD1$PredictedProb)
soycostD1<-subset(D1, (D1$soycost=="14"))
mean(soycostD1$PredictedProb)

ALED1<-subset(D1, (D1$location=="ALE"))
mean(ALED1$UL)
HILD1<-subset(D1, (D1$location=="HIL"))
mean(HILD1$UL)
IN2D1<-subset(D1, (D1$location=="IN2"))
mean(IN2D1$UL)
LEND1<-subset(D1, (D1$location=="LEN"))
mean(LEND1$UL)
SAGD1<-subset(D1, (D1$location=="SAG"))
mean(SAGD1$UL)
SAND1<-subset(D1, (D1$location=="SAN"))
mean(SAND1$UL)
STJD1<-subset(D1, (D1$location=="STJ"))
mean(STJD1$UL)
sdtrtD1<-subset(D1, (D1$sdtrt=="F"))
mean(sdtrtD1$UL)
sdtrtD1<-subset(D1, (D1$sdtrt=="F+I"))
mean(sdtrtD1$UL)
sdtrtD1<-subset(D1, (D1$sdtrt=="F+I+N"))
mean(sdtrtD1$UL)
varD1<-subset(D1, (D1$var=="1"))
mean(varD1$UL)
varD1<-subset(D1, (D1$var=="2"))
mean(varD1$UL)
varD1<-subset(D1, (D1$var=="3"))
mean(varD1$UL)
varD1<-subset(D1, (D1$var=="4"))
mean(varD1$UL)
varD1<-subset(D1, (D1$var=="5"))
mean(varD1$UL)
varD1<-subset(D1, (D1$var=="6"))
mean(varD1$UL)
soycostD1<-subset(D1, (D1$soycost=="6"))
mean(soycostD1$UL)
soycostD1<-subset(D1, (D1$soycost=="10"))
mean(soycostD1$UL)
soycostD1<-subset(D1, (D1$soycost=="14"))
mean(soycostD1$UL)

ALED1<-subset(D1, (D1$location=="ALE"))
mean(ALED1$LL)
HILD1<-subset(D1, (D1$location=="HIL"))
mean(HILD1$LL)
IN2D1<-subset(D1, (D1$location=="IN2"))
mean(IN2D1$LL)
LEND1<-subset(D1, (D1$location=="LEN"))
mean(LEND1$LL)
SAGD1<-subset(D1, (D1$location=="SAG"))
mean(SAGD1$LL)
SAND1<-subset(D1, (D1$location=="SAN"))
mean(SAND1$LL)
STJD1<-subset(D1, (D1$location=="STJ"))
mean(STJD1$LL)
sdtrtD1<-subset(D1, (D1$sdtrt=="F"))
mean(sdtrtD1$LL)
sdtrtD1<-subset(D1, (D1$sdtrt=="F+I"))
mean(sdtrtD1$LL)
sdtrtD1<-subset(D1, (D1$sdtrt=="F+I+N"))
mean(sdtrtD1$LL)
varD1<-subset(D1, (D1$var=="1"))
mean(varD1$LL)
varD1<-subset(D1, (D1$var=="2"))
mean(varD1$LL)
varD1<-subset(D1, (D1$var=="3"))
mean(varD1$LL)
varD1<-subset(D1, (D1$var=="4"))
mean(varD1$LL)
varD1<-subset(D1, (D1$var=="5"))
mean(varD1$LL)
varD1<-subset(D1, (D1$var=="6"))
mean(varD1$LL)
soycostD1<-subset(D1, (D1$soycost=="6"))
mean(soycostD1$LL)
soycostD1<-subset(D1, (D1$soycost=="10"))
mean(soycostD1$LL)
soycostD1<-subset(D1, (D1$soycost=="14"))
mean(soycostD1$LL)

###By $6.00/bu
ALED1<-subset(D1, (D1$soycost=="6" & D1$location=="ALE"))
mean(ALED1$PredictedProb)
HILD1<-subset(D1, (D1$soycost=="6" & D1$location=="HIL"))
mean(HILD1$PredictedProb)
IN2D1<-subset(D1, (D1$soycost=="6" & D1$location=="IN2"))
mean(IN2D1$PredictedProb)
LEND1<-subset(D1, (D1$soycost=="6" & D1$location=="LEN"))
mean(LEND1$PredictedProb)
SAGD1<-subset(D1, (D1$soycost=="6" & D1$location=="SAG"))
mean(SAGD1$PredictedProb)
SAND1<-subset(D1, (D1$soycost=="6" & D1$location=="SAN"))
mean(SAND1$PredictedProb)
STJD1<-subset(D1, (D1$soycost=="6" & D1$location=="STJ"))
mean(STJD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$soycost=="6" & D1$sdtrt=="F"))
mean(sdtrtD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$soycost=="6" & D1$sdtrt=="F+I"))
mean(sdtrtD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$soycost=="6" & D1$sdtrt=="F+I+N"))
mean(sdtrtD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="1"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="2"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="3"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="4"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="5"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="6"))
mean(varD1$PredictedProb)

ALED1<-subset(D1, (D1$soycost=="6" & D1$location=="ALE"))
mean(ALED1$UL)
HILD1<-subset(D1, (D1$soycost=="6" & D1$location=="HIL"))
mean(HILD1$UL)
IN2D1<-subset(D1, (D1$soycost=="6" & D1$location=="IN2"))
mean(IN2D1$UL)
LEND1<-subset(D1, (D1$soycost=="6" & D1$location=="LEN"))
mean(LEND1$UL)
SAGD1<-subset(D1, (D1$soycost=="6" & D1$location=="SAG"))
mean(SAGD1$UL)
SAND1<-subset(D1, (D1$soycost=="6" & D1$location=="SAN"))
mean(SAND1$UL)
STJD1<-subset(D1, (D1$soycost=="6" & D1$location=="STJ"))
mean(STJD1$UL)
sdtrtD1<-subset(D1, (D1$soycost=="6" & D1$sdtrt=="F"))
mean(sdtrtD1$UL)
sdtrtD1<-subset(D1, (D1$soycost=="6" & D1$sdtrt=="F+I"))
mean(sdtrtD1$UL)
sdtrtD1<-subset(D1, (D1$soycost=="6" & D1$sdtrt=="F+I+N"))
mean(sdtrtD1$UL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="1"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="2"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="3"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="4"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="5"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="6"))
mean(varD1$UL)

ALED1<-subset(D1, (D1$soycost=="6" & D1$location=="ALE"))
mean(ALED1$LL)
HILD1<-subset(D1, (D1$soycost=="6" & D1$location=="HIL"))
mean(HILD1$LL)
IN2D1<-subset(D1, (D1$soycost=="6" & D1$location=="IN2"))
mean(IN2D1$LL)
LEND1<-subset(D1, (D1$soycost=="6" & D1$location=="LEN"))
mean(LEND1$LL)
SAGD1<-subset(D1, (D1$soycost=="6" & D1$location=="SAG"))
mean(SAGD1$LL)
SAND1<-subset(D1, (D1$soycost=="6" & D1$location=="SAN"))
mean(SAND1$LL)
STJD1<-subset(D1, (D1$soycost=="6" & D1$location=="STJ"))
mean(STJD1$LL)
sdtrtD1<-subset(D1, (D1$soycost=="6" & D1$sdtrt=="F"))
mean(sdtrtD1$LL)
sdtrtD1<-subset(D1, (D1$soycost=="6" & D1$sdtrt=="F+I"))
mean(sdtrtD1$LL)
sdtrtD1<-subset(D1, (D1$soycost=="6" & D1$sdtrt=="F+I+N"))
mean(sdtrtD1$LL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="1"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="2"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="3"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="4"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="5"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="6" & D1$var=="6"))
mean(varD1$LL)

###By $10.00/bu
ALED1<-subset(D1, (D1$soycost=="10" & D1$location=="ALE"))
mean(ALED1$PredictedProb)
HILD1<-subset(D1, (D1$soycost=="10" & D1$location=="HIL"))
mean(HILD1$PredictedProb)
IN2D1<-subset(D1, (D1$soycost=="10" & D1$location=="IN2"))
mean(IN2D1$PredictedProb)
LEND1<-subset(D1, (D1$soycost=="10" & D1$location=="LEN"))
mean(LEND1$PredictedProb)
SAGD1<-subset(D1, (D1$soycost=="10" & D1$location=="SAG"))
mean(SAGD1$PredictedProb)
SAND1<-subset(D1, (D1$soycost=="10" & D1$location=="SAN"))
mean(SAND1$PredictedProb)
STJD1<-subset(D1, (D1$soycost=="10" & D1$location=="STJ"))
mean(STJD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$soycost=="10" & D1$sdtrt=="F"))
mean(sdtrtD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$soycost=="10" & D1$sdtrt=="F+I"))
mean(sdtrtD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$soycost=="10" & D1$sdtrt=="F+I+N"))
mean(sdtrtD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="1"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="2"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="3"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="4"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="5"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="6"))
mean(varD1$PredictedProb)

ALED1<-subset(D1, (D1$soycost=="10" & D1$location=="ALE"))
mean(ALED1$UL)
HILD1<-subset(D1, (D1$soycost=="10" & D1$location=="HIL"))
mean(HILD1$UL)
IN2D1<-subset(D1, (D1$soycost=="10" & D1$location=="IN2"))
mean(IN2D1$UL)
LEND1<-subset(D1, (D1$soycost=="10" & D1$location=="LEN"))
mean(LEND1$UL)
SAGD1<-subset(D1, (D1$soycost=="10" & D1$location=="SAG"))
mean(SAGD1$UL)
SAND1<-subset(D1, (D1$soycost=="10" & D1$location=="SAN"))
mean(SAND1$UL)
STJD1<-subset(D1, (D1$soycost=="10" & D1$location=="STJ"))
mean(STJD1$UL)
sdtrtD1<-subset(D1, (D1$soycost=="10" & D1$sdtrt=="F"))
mean(sdtrtD1$UL)
sdtrtD1<-subset(D1, (D1$soycost=="10" & D1$sdtrt=="F+I"))
mean(sdtrtD1$UL)
sdtrtD1<-subset(D1, (D1$soycost=="10" & D1$sdtrt=="F+I+N"))
mean(sdtrtD1$UL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="1"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="2"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="3"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="4"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="5"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="6"))
mean(varD1$UL)

ALED1<-subset(D1, (D1$soycost=="10" & D1$location=="ALE"))
mean(ALED1$LL)
HILD1<-subset(D1, (D1$soycost=="10" & D1$location=="HIL"))
mean(HILD1$LL)
IN2D1<-subset(D1, (D1$soycost=="10" & D1$location=="IN2"))
mean(IN2D1$LL)
LEND1<-subset(D1, (D1$soycost=="10" & D1$location=="LEN"))
mean(LEND1$LL)
SAGD1<-subset(D1, (D1$soycost=="10" & D1$location=="SAG"))
mean(SAGD1$LL)
SAND1<-subset(D1, (D1$soycost=="10" & D1$location=="SAN"))
mean(SAND1$LL)
STJD1<-subset(D1, (D1$soycost=="10" & D1$location=="STJ"))
mean(STJD1$LL)
sdtrtD1<-subset(D1, (D1$soycost=="10" & D1$sdtrt=="F"))
mean(sdtrtD1$LL)
sdtrtD1<-subset(D1, (D1$soycost=="10" & D1$sdtrt=="F+I"))
mean(sdtrtD1$LL)
sdtrtD1<-subset(D1, (D1$soycost=="10" & D1$sdtrt=="F+I+N"))
mean(sdtrtD1$LL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="1"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="2"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="3"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="4"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="5"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="10" & D1$var=="6"))
mean(varD1$LL)

###By $14.00/bu
ALED1<-subset(D1, (D1$soycost=="14" & D1$location=="ALE"))
mean(ALED1$PredictedProb)
HILD1<-subset(D1, (D1$soycost=="14" & D1$location=="HIL"))
mean(HILD1$PredictedProb)
IN2D1<-subset(D1, (D1$soycost=="14" & D1$location=="IN2"))
mean(IN2D1$PredictedProb)
LEND1<-subset(D1, (D1$soycost=="14" & D1$location=="LEN"))
mean(LEND1$PredictedProb)
SAGD1<-subset(D1, (D1$soycost=="14" & D1$location=="SAG"))
mean(SAGD1$PredictedProb)
SAND1<-subset(D1, (D1$soycost=="14" & D1$location=="SAN"))
mean(SAND1$PredictedProb)
STJD1<-subset(D1, (D1$soycost=="14" & D1$location=="STJ"))
mean(STJD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$soycost=="14" & D1$sdtrt=="F"))
mean(sdtrtD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$soycost=="14" & D1$sdtrt=="F+I"))
mean(sdtrtD1$PredictedProb)
sdtrtD1<-subset(D1, (D1$soycost=="14" & D1$sdtrt=="F+I+N"))
mean(sdtrtD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="1"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="2"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="3"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="4"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="5"))
mean(varD1$PredictedProb)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="6"))
mean(varD1$PredictedProb)

ALED1<-subset(D1, (D1$soycost=="14" & D1$location=="ALE"))
mean(ALED1$UL)
HILD1<-subset(D1, (D1$soycost=="14" & D1$location=="HIL"))
mean(HILD1$UL)
IN2D1<-subset(D1, (D1$soycost=="14" & D1$location=="IN2"))
mean(IN2D1$UL)
LEND1<-subset(D1, (D1$soycost=="14" & D1$location=="LEN"))
mean(LEND1$UL)
SAGD1<-subset(D1, (D1$soycost=="14" & D1$location=="SAG"))
mean(SAGD1$UL)
SAND1<-subset(D1, (D1$soycost=="14" & D1$location=="SAN"))
mean(SAND1$UL)
STJD1<-subset(D1, (D1$soycost=="14" & D1$location=="STJ"))
mean(STJD1$UL)
sdtrtD1<-subset(D1, (D1$soycost=="14" & D1$sdtrt=="F"))
mean(sdtrtD1$UL)
sdtrtD1<-subset(D1, (D1$soycost=="14" & D1$sdtrt=="F+I"))
mean(sdtrtD1$UL)
sdtrtD1<-subset(D1, (D1$soycost=="14" & D1$sdtrt=="F+I+N"))
mean(sdtrtD1$UL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="1"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="2"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="3"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="4"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="5"))
mean(varD1$UL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="6"))
mean(varD1$UL)

ALED1<-subset(D1, (D1$soycost=="14" & D1$location=="ALE"))
mean(ALED1$LL)
HILD1<-subset(D1, (D1$soycost=="14" & D1$location=="HIL"))
mean(HILD1$LL)
IN2D1<-subset(D1, (D1$soycost=="14" & D1$location=="IN2"))
mean(IN2D1$LL)
LEND1<-subset(D1, (D1$soycost=="14" & D1$location=="LEN"))
mean(LEND1$LL)
SAGD1<-subset(D1, (D1$soycost=="14" & D1$location=="SAG"))
mean(SAGD1$LL)
SAND1<-subset(D1, (D1$soycost=="14" & D1$location=="SAN"))
mean(SAND1$LL)
STJD1<-subset(D1, (D1$soycost=="14" & D1$location=="STJ"))
mean(STJD1$LL)
sdtrtD1<-subset(D1, (D1$soycost=="14" & D1$sdtrt=="F"))
mean(sdtrtD1$LL)
sdtrtD1<-subset(D1, (D1$soycost=="14" & D1$sdtrt=="F+I"))
mean(sdtrtD1$LL)
sdtrtD1<-subset(D1, (D1$soycost=="14" & D1$sdtrt=="F+I+N"))
mean(sdtrtD1$LL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="1"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="2"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="3"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="4"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="5"))
mean(varD1$LL)
varD1<-subset(D1, (D1$soycost=="14" & D1$var=="6"))
mean(varD1$LL)

LocY3<-subset(Y3, (Y3$location=="ALE"))
mean(LocY3$RR)
LocY3<-subset(Y3, (Y3$location=="HIL"))
mean(LocY3$RR)
LocY3<-subset(Y3, (Y3$location=="IN2"))
mean(LocY3$RR)
LocY3<-subset(Y3, (Y3$location=="LEN"))
mean(LocY3$RR)
LocY3<-subset(Y3, (Y3$location=="SAG"))
mean(LocY3$RR)
LocY3<-subset(Y3, (Y3$location=="SAN"))
mean(LocY3$RR)
LocY3<-subset(Y3, (Y3$location=="STJ"))
mean(LocY3$RR)
sdtrtY3<-subset(Y3, (Y3$sdtrt=="F"))
mean(sdtrtY3$RR)
sdtrtY3<-subset(Y3, (Y3$sdtrt=="F+I"))
mean(sdtrtY3$RR)
sdtrtY3<-subset(Y3, (Y3$sdtrt=="F+I+N"))
mean(sdtrtY3$RR)
varY3<-subset(Y3, (Y3$var=="1"))
mean(varY3$RR)
varY3<-subset(Y3, (Y3$var=="2"))
mean(varY3$RR)
varY3<-subset(Y3, (Y3$var=="3"))
mean(varY3$RR)
varY3<-subset(Y3, (Y3$var=="4"))
mean(varY3$RR)
varY3<-subset(Y3, (Y3$var=="5"))
mean(varY3$RR)
varY3<-subset(Y3, (Y3$var=="6"))
mean(varY3$RR)




```

